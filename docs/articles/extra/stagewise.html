<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stagewise mixed-model analysis • inti</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><!-- docsearch --><script src="../../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Stagewise mixed-model analysis">
<meta property="og:description" content="Comparison: asreml and H2cal">
<meta property="og:image" content="https://flavjack.github.io/inti/reference/figures/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-804H2EJ8RN"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-804H2EJ8RN');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">inti</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa-home fa-lg"></span>
     
    
  </a>
</li>
<li>
  <a href="../../articles/apps.html">
    <span class="fas fa-gamepad fa-lg"></span>
     
    Apps
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-book fa-lg"></span>
     
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/tarpuy.html">Tarpuy: field-book experimental plans</a>
    </li>
    <li>
      <a href="../../articles/yupana.html">Yupana: experimental design analysis</a>
    </li>
    <li>
      <a href="../../articles/rticles.html">Rticles: scientific documents with R</a>
    </li>
    <li>
      <a href="../../articles/heritability.html">Broad-sense heritability in plant breeding</a>
    </li>
    <li>
      <a href="../../articles/extra/stagewise.html">Stagewise mixed-model analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../articles/policy.html">
    <span class="fas fa-shield-alt fa-lg"></span>
     
    Privacy Policy
  </a>
</li>
<li>
  <a href="../../reference/index.html">
    <span class="fas fa-file-code fa-lg"></span>
     
    Functions
  </a>
</li>
<li>
  <a href="../../news/index.html">
    <span class="fas fa-file-alt fa-lg"></span>
     
    News
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/flavjack/inti/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/sponsors/Flavjack">
    <span class="fas fa-heart fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="stagewise_files/header-attrs-2.8/header-attrs.js"></script><script src="stagewise_files/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="stagewise_files/jquery-3.5.1/jquery.min.js"></script><link href="stagewise_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="stagewise_files/datatables-binding-0.18/datatables.js"></script><link href="stagewise_files/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="stagewise_files/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="stagewise_files/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><script src="stagewise_files/jszip-1.10.20/jszip.min.js"></script><link href="stagewise_files/dt-ext-buttons-1.10.20/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="stagewise_files/dt-ext-buttons-1.10.20/js/dataTables.buttons.min.js"></script><script src="stagewise_files/dt-ext-buttons-1.10.20/js/buttons.flash.min.js"></script><script src="stagewise_files/dt-ext-buttons-1.10.20/js/buttons.html5.min.js"></script><script src="stagewise_files/dt-ext-buttons-1.10.20/js/buttons.colVis.min.js"></script><script src="stagewise_files/dt-ext-buttons-1.10.20/js/buttons.print.min.js"></script><link href="stagewise_files/dt-ext-scroller-1.10.20/css/scroller.dataTables.min.css" rel="stylesheet">
<script src="stagewise_files/dt-ext-scroller-1.10.20/js/dataTables.scroller.min.js"></script><link href="stagewise_files/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="stagewise_files/crosstalk-1.1.1/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Stagewise mixed-model analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/flavjack/inti/blob/master/vignettes/extra/stagewise.Rmd"><code>vignettes/extra/stagewise.Rmd</code></a></small>
      <div class="hidden name"><code>stagewise.Rmd</code></div>

    </div>

    
    
<p>Best linear unbiased prediction (BLUP) is used in plant breeding experiments for the selection of the best lines in multi-environmental trials (MET).</p>
<p>In this section, a comparison will be made between the <code>H2Cal()</code> function of the inti package <span class="citation">(<a href="#ref-R-inti" role="doc-biblioref">Lozano-Isla, 2020</a>)</span> and the code using the <code>asrml</code> package published by <span class="citation"><a href="#ref-buntaran2020Cross" role="doc-biblioref">Buntaran et al.</a> (<a href="#ref-buntaran2020Cross" role="doc-biblioref">2020</a>)</span>.</p>
<p>For the comparison we will use the two methods described by <span class="citation"><a href="#ref-buntaran2020Cross" role="doc-biblioref">Buntaran et al.</a> (<a href="#ref-buntaran2020Cross" role="doc-biblioref">2020</a>)</span>. (i) The “two-stage” analysis, using two stages, the first to calculate the BLUEs and the second the BLUPs. (ii) The “one stage” analysis using only one model to calculate the BLUPs.</p>
<div id="load-data" class="section level1">
<h1 class="hasAnchor">
<a href="#load-data" class="anchor"></a>Load data</h1>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://inkaverse.com/">inti</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://purrr.tidyverse.org">purrr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="va">fb</span> <span class="op">&lt;-</span> <span class="fu">inti</span><span class="fu">::</span><span class="va"><a href="../../reference/met.html">met</a></span></code></pre></div>
</div>
<div id="two-stage-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#two-stage-analysis" class="anchor"></a>Two-stage analysis</h1>
<div id="asreml" class="section level2">
<h2 class="hasAnchor">
<a href="#asreml" class="anchor"></a>asreml</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">asreml</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com">data.table</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://had.co.nz/plyr">plyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://stringr.tidyverse.org">stringr</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.options.html">asreml.options</a></span><span class="op">(</span>maxit<span class="op">=</span><span class="fl">100</span><span class="op">)</span> <span class="co"># Set asreml iteration</span>

<span class="co">############################</span>
<span class="co">##### Stage I LSMEANS #####</span>
<span class="co">##### per location   #####</span>

<span class="va">ww</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html">data.table</a></span><span class="op">(</span><span class="va">fb</span><span class="op">)</span>

<span class="co">##### Make column Zone_Loc #####</span>

<span class="va">trials</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nlevels.html">nlevels</a></span><span class="op">(</span><span class="va">ww</span><span class="op">$</span><span class="va">env</span><span class="op">)</span>
<span class="va">envs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">ww</span><span class="op">$</span><span class="va">env</span><span class="op">)</span>

<span class="co">##### Make data list for Stage I #####</span>
<span class="va">data_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">envs</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">1</span>, 
                    dimnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">envs</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"data_Set"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co">##### Make a list of Trials #####</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">trials</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>
  <span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">ww</span><span class="op">$</span><span class="va">env</span><span class="op">)</span>
  <span class="va">c</span> <span class="op">&lt;-</span> <span class="va">b</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span>
  <span class="va">env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html">data.table</a></span><span class="op">(</span><span class="va">env</span><span class="op">)</span>
  <span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html">merge</a></span><span class="op">(</span><span class="va">ww</span>,<span class="va">env</span>,by<span class="op">=</span><span class="st">"env"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"data_"</span>, <span class="va">b</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>, <span class="va">f</span><span class="op">)</span>
  <span class="va">data_list</span><span class="op">[[</span><span class="va">i</span>, <span class="st">"data_Set"</span> <span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">f</span>
  
  <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">b</span>, <span class="va">c</span>, <span class="va">f</span>, <span class="va">env</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">data_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html">data.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/ldply.html">ldply</a></span><span class="op">(</span><span class="va">data_list</span><span class="op">[</span>, <span class="st">"data_Set"</span><span class="op">]</span>, <span class="va">data.frame</span>, .id<span class="op">=</span><span class="st">"env"</span><span class="op">)</span><span class="op">)</span>

<span class="va">stgI_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">envs</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">1</span>, 
                    dimnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">envs</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lsmeans"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.options.html">asreml.options</a></span><span class="op">(</span>maxit<span class="op">=</span><span class="fl">100</span><span class="op">)</span> <span class="co"># Set asreml iteration</span>

<span class="co">############################</span>
<span class="co">##### Stage I LSMEANS #####</span>
<span class="co">##### per location   #####</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">envs</span><span class="op">)</span><span class="op">{</span>
  
  <span class="va">edat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html">droplevels</a></span><span class="op">(</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/subset.data.table.html">subset</a></span><span class="op">(</span><span class="va">ww</span>, <span class="va">env</span> <span class="op">==</span> <span class="va">i</span><span class="op">)</span><span class="op">)</span>
  
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>
  
  <span class="va">mod.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html">asreml</a></span><span class="op">(</span>fixed     <span class="op">=</span> <span class="va">yield</span> <span class="op">~</span> <span class="va">cultivar</span>,
                  random      <span class="op">=</span> <span class="op">~</span> <span class="va">rep</span> <span class="op">+</span> <span class="va">rep</span><span class="op">:</span><span class="va">alpha</span>,
                  data        <span class="op">=</span> <span class="va">edat</span>,
                  predict     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/predict.asreml.html">predict.asreml</a></span><span class="op">(</span>classify <span class="op">=</span> <span class="st">"cultivar"</span><span class="op">)</span><span class="op">)</span>
  
  <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/update.asreml.html">update.asreml</a></span><span class="op">(</span><span class="va">mod.1</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/summary.asreml.html">summary.asreml</a></span><span class="op">(</span><span class="va">mod.1</span><span class="op">)</span><span class="op">$</span><span class="va">varcomp</span><span class="op">)</span>
  
  <span class="va">blue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mod.1</span>, classify<span class="op">=</span><span class="st">"cultivar"</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">edat</span><span class="op">$</span><span class="va">cultivar</span><span class="op">)</span>, vcov<span class="op">=</span><span class="cn">TRUE</span>,aliased <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co"># get the lsmeans</span>
  <span class="va">blue.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html">data.table</a></span><span class="op">(</span><span class="va">blue</span><span class="op">$</span><span class="va">pvals</span><span class="op">)</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">blue.1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cultivar"</span>, <span class="st">"yield_lsm"</span>, <span class="st">"se"</span><span class="op">)</span>
  <span class="va">blue.1</span><span class="op">[</span> , <span class="st">':='</span><span class="op">(</span>var<span class="op">=</span><span class="va">se</span><span class="op">^</span><span class="fl">2</span>, smith.w<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/unstructured.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="va">blue</span><span class="op">$</span><span class="va">vcov</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="co"># calculate the Smith's weight</span>
  
  <span class="va">stgI_list</span><span class="op">[[</span><span class="va">i</span>, <span class="st">"lsmeans"</span> <span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">blue.1</span> <span class="co"># put all the results of Stage 1 in the list</span>
  
  <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">Edat</span>,<span class="va">mod.1</span>, <span class="va">blue</span>, <span class="va">blue.1</span><span class="op">)</span>
<span class="op">}</span>

<span class="co">#######################################################</span>
<span class="co">##### Preparing dataset of Stage I for Stage II ######</span>

<span class="co">##### Unlist the results of Stage I and format as data.table #####</span>
<span class="va">stgII_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html">data.table</a></span><span class="op">(</span><span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/ldply.html">ldply</a></span><span class="op">(</span><span class="va">stgI_list</span><span class="op">[</span>, <span class="st">"lsmeans"</span><span class="op">]</span>, <span class="va">data.frame</span>, .id<span class="op">=</span><span class="st">"env"</span><span class="op">)</span><span class="op">)</span>

<span class="va">stgII_list</span><span class="op">$</span><span class="va">zone</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split_fixed</a></span><span class="op">(</span><span class="va">stgII_list</span><span class="op">$</span><span class="va">env</span>, <span class="st">"_"</span>, <span class="fl">2</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="co"># Make Zone column by split the record in Zone_Loc column</span>
<span class="va">stgII_list</span><span class="op">$</span><span class="va">location</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split_fixed</a></span><span class="op">(</span><span class="va">stgII_list</span><span class="op">$</span><span class="va">env</span>, <span class="st">"_"</span>, <span class="fl">3</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>  <span class="co"># Make Location by split the record in Zone_Loc column</span>
<span class="va">stgII_list</span><span class="op">$</span><span class="va">year</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split_fixed</a></span><span class="op">(</span><span class="va">stgII_list</span><span class="op">$</span><span class="va">env</span>, <span class="st">"_"</span>, <span class="fl">3</span><span class="op">)</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="co"># Make Year by split the record in Zone_Loc column</span>

<span class="va">blues.asreml</span> <span class="op">&lt;-</span> <span class="va">stgII_list</span>

<span class="co">############################</span>
<span class="co">##### Stage II BLUPs ######</span>
<span class="co">##### Zone analysis #####</span>

<span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html">asreml</a></span><span class="op">(</span><span class="va">yield_lsm</span>  <span class="op">~</span> <span class="va">zone</span>,
                random    <span class="op">=</span> <span class="op">~</span><span class="va">cultivar</span> <span class="op">+</span> <span class="va">zone</span><span class="op">:</span><span class="va">location</span> <span class="op">+</span> <span class="va">zone</span><span class="op">:</span><span class="va">cultivar</span> <span class="op">+</span> <span class="va">cultivar</span><span class="op">:</span><span class="va">zone</span><span class="op">:</span><span class="va">location</span>,
                weights   <span class="op">=</span> <span class="va">smith.w</span>,
                family    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asr_families.html">asr_gaussian</a></span><span class="op">(</span>dispersion<span class="op">=</span><span class="fl">1.0</span><span class="op">)</span>, <span class="co"># fix residual variance to 1</span>
                data      <span class="op">=</span> <span class="va">blues.asreml</span>,
                predict   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/predict.asreml.html">predict.asreml</a></span><span class="op">(</span>classify <span class="op">=</span> <span class="st">"cultivar"</span><span class="op">)</span>
                <span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/asreml/man/update.asreml.html">update.asreml</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>

<span class="co"># print(summary.asreml(model)$varcomp) # print the variance components</span>

<span class="va">blups.asrml</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">predictions</span><span class="op">$</span><span class="va">pvals</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="h2cal" class="section level2">
<h2 class="hasAnchor">
<a href="#h2cal" class="anchor"></a>H2cal</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://inkaverse.com/">inti</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://purrr.tidyverse.org">purrr</a></span><span class="op">)</span>

<span class="co">#&gt; First stage</span>

<span class="va">envs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">fb</span><span class="op">$</span><span class="va">env</span><span class="op">)</span>

<span class="va">model</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">envs</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  
  <span class="va">model</span> <span class="op">&lt;-</span> <span class="va">fb</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">env</span> <span class="op">%in%</span> <span class="va">envs</span><span class="op">[</span><span class="va">x</span><span class="op">]</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    
    <span class="fu"><a href="../../reference/H2cal.html">H2cal</a></span><span class="op">(</span>trait <span class="op">=</span> <span class="st">"yield"</span>
          , gen.name <span class="op">=</span> <span class="st">"cultivar"</span>
          , rep.n <span class="op">=</span> <span class="fl">4</span>
          , ran.model <span class="op">=</span> <span class="st">"1 + (1|rep:alpha) + (1|cultivar)"</span>
          , fix.model <span class="op">=</span> <span class="st">"0 + (1|rep:alpha) + cultivar"</span>
          , emmeans <span class="op">=</span> <span class="cn">F</span>
          <span class="op">)</span>
  
  <span class="va">blues</span> <span class="op">&lt;-</span> <span class="va">model</span><span class="op">$</span><span class="va">blues</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mutate.html">mutate</a></span><span class="op">(</span>trial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">fb</span><span class="op">$</span><span class="va">env</span><span class="op">)</span><span class="op">[</span><span class="va">x</span><span class="op">]</span><span class="op">)</span>
  
  <span class="op">}</span><span class="op">)</span>

<span class="va">blues.h2cal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">separate</span><span class="op">(</span><span class="va">trial</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"zone"</span>, <span class="st">"location"</span>, <span class="st">"year"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">yield</span>, <span class="va">smith.w</span><span class="op">)</span>, <span class="va">as.numeric</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">yield</span>, <span class="va">smith.w</span><span class="op">)</span>, <span class="va">as.factor</span><span class="op">)</span><span class="op">)</span>

<span class="co">#&gt; Second stage</span>

<span class="va">met</span> <span class="op">&lt;-</span> <span class="va">blues.h2cal</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="op">!</span><span class="va">yield</span>, <span class="va">as.factor</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../../reference/H2cal.html">H2cal</a></span><span class="op">(</span>trait <span class="op">=</span> <span class="st">"yield"</span>
        , gen.name <span class="op">=</span> <span class="st">"cultivar"</span>
        , rep.n <span class="op">=</span> <span class="fl">4</span>
        , loc.n <span class="op">=</span> <span class="fl">18</span>
        , loc.name <span class="op">=</span> <span class="st">"Location"</span>
        , ran.model <span class="op">=</span> <span class="st">"1 + (1|zone:location) + (1|zone:cultivar) + (1|cultivar)"</span>
        , fix.model <span class="op">=</span> <span class="st">"0 + (1|zone:location) + (1|zone:cultivar) + cultivar"</span>
        , emmeans <span class="op">=</span> <span class="cn">T</span>
        <span class="co"># , weights = blues.h2cal$smith.w</span>
        <span class="op">)</span>

<span class="va">blups.h2cal</span> <span class="op">&lt;-</span> <span class="va">met</span><span class="op">$</span><span class="va">blups</span></code></pre></div>
<ul>
<li>First stage
<ul>
<li>Fixed model with <code>0 +</code> for avoid intercep and calculate all the BLUEs.</li>
<li>
<code>emmeans = F</code> to calculate the Smith weitghts in the first stage</li>
</ul>
</li>
</ul>
</div>
<div id="blues-comparison" class="section level2">
<h2 class="hasAnchor">
<a href="#blues-comparison" class="anchor"></a>BLUEs comparison</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">blues.comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html">merge</a></span><span class="op">(</span><span class="va">blues.asreml</span> 
                    , <span class="va">blues.h2cal</span> 
                    , by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cultivar"</span>, <span class="st">"zone"</span>, <span class="st">"location"</span><span class="op">)</span><span class="op">)</span>

<span class="va">rs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/unstructured.html">cor</a></span><span class="op">(</span><span class="va">blues.comp</span><span class="op">$</span><span class="va">yield</span>, <span class="va">blues.comp</span><span class="op">$</span><span class="va">yield_lsm</span><span class="op">)</span> <span class="co"># 0.9999286</span>
<span class="va">rs</span>
<span class="co">## [1] 0.9999286</span>

<span class="va">blues.comp</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../../reference/web_table.html">web_table</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-0f44601f43a36b894f70" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-0f44601f43a36b894f70">{"x":{"filter":"none","extensions":["Buttons","Scroller"],"data":[["22455","22455","22455","22455","22455","22455","22455","22455","22455","22455","22455","22455","22455","22455","22455","22455","22455","22455","23286","23286","23286","23286","23286","23286","23286","23286","23286","23286","23286","23286","23286","23286","23286","23286","23286","23286","23524","23524","23524","23524","23524","23524","23524","23524","23524","23524","23524","23524","23524","23524","23524","23524","23524","23524","24054","24054","24054","24054","24054","24054","24054","24054","24054","24054","24054","24054","24054","24054","24054","24054","24054","24054","24521","24521","24521","24521","24521","24521","24521","24521","24521","24521","24521","24521","24521","24521","24521","24521","24521","24521","24984","24984","24984","24984","24984","24984","24984","24984","24984","24984","24984","24984","24984","24984","24984","24984","24984","24984","25512","25512","25512","25512","25512","25512","25512","25512","25512","25512","25512","25512","25512","25512","25512","25512","25512","25512","25965","25965","25965","25965","25965","25965","25965","25965","25965","25965","25965","25965","25965","25965","25965","25965","25965","25965","26362","26362","26362","26362","26362","26362","26362","26362","26362","26362","26362","26362","26362","26362","26362","26362","26362","26742","26742","26742","26742","26742","26742","26742","26742","26742","26742","26742","26742","26742","26742","26742","26742","26742","26742","26777","26777","26777","26777","26777","26777","26777","26777","26777","26777","26777","26777","26777","26777","26777","26777","26777","26777","27110","27110","27110","27110","27110","27110","27110","27110","27110","27110","27110","27110","27110","27110","27110","27110","27110","27110","27125","27125","27125","27125","27125","27125","27125","27125","27125","27125","27125","27125","27125","27125","27125","27125","27125","27125","27130","27130","27130","27130","27130","27130","27130","27130","27130","27130","27130","27130","27130","27130","27130","27130","27130","27130","27543","27543","27543","27543","27543","27543","27543","27543","27543","27543","27543","27543","27543","27543","27543","27543","27543","27543","27546","27546","27546","27546","27546","27546","27546","27546","27546","27546","27546","27546","27546","27546","27546","27546","27546","27546","27548","27548","27548","27548","27548","27548","27548","27548","27548","27548","27548","27548","27548","27548","27548","27548","27548","27548","27590","27590","27590","27590","27590","27590","27590","27590","27590","27590","27590","27590","27590","27590","27590","27590","27590","27590","27592","27592","27592","27592","27592","27592","27592","27592","27592","27592","27592","27592","27592","27592","27592","27592","27592","27592","27593","27593","27593","27593","27593","27593","27593","27593","27593","27593","27593","27593","27593","27593","27593","27593","27593","27593","27599","27599","27599","27599","27599","27599","27599","27599","27599","27599","27599","27599","27599","27599","27599","27599","27599","27599","27600","27600","27600","27600","27600","27600","27600","27600","27600","27600","27600","27600","27600","27600","27600","27600","27600","27600","27605","27605","27605","27605","27605","27605","27605","27605","27605","27605","27605","27605","27605","27605","27605","27605","27605","27605","27609","27609","27609","27609","27609","27609","27609","27609","27609","27609","27609","27609","27609","27609","27609","27609","27609","27609","27669","27669","27669","27669","27669","27669","27669","27669","27669","27669","27669","27669","27669","27669","27669","27669","27669","27669","28128","28128","28128","28128","28128","28128","28128","28128","28128","28128","28128","28128","28128","28128","28128","28128","28128","28128","28209","28209","28209","28209","28209","28209","28209","28209","28209","28209","28209","28209","28209","28209","28209","28209","28209","28209","28949","28949","28949","28949","28949","28949","28949","28949","28949","28949","28949","28949","28949","28949","28949","28949","28949","28949","28950","28950","28950","28950","28950","28950","28950","28950","28950","28950","28950","28950","28950","28950","28950","28950","28950","28950","28954","28954","28954","28954","28954","28954","28954","28954","28954","28954","28954","28954","28954","28954","28954","28954","28954","28954"],["middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south"],["07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35"],[1053.89,676.78,392.89,996.93,594.25,507.97,1139.67,579.71,934.16,946.94,774.44,865.61,726.91,983.65,804.74,845.63,709.35,775.31,1027.16,722.16,503.13,1025.19,633.61,517.77,1108.76,571.72,987.23,950.04,766.52,905.16,816.25,1097.75,866.47,910.64,638.39,725.59,1009.42,633.61,332.56,1014.21,539.37,472.34,1195.59,564.4,1016.25,879.75,718.46,907.81,812.68,1061.93,796.22,892.85,562.64,827.86,1089.27,704.1,304.57,1089.48,653.11,592.06,1304.21,664.98,1068.02,1009.69,851.67,903.74,890.83,1163.25,970.18,895.93,506.14,734.3,1090.53,739.32,592.47,1089.56,685.92,559.49,1185.9,575.56,1038.38,997.56,791.21,957.16,859.49,1111.95,910.6,943.05,749.52,867.44,1150.69,656.46,449.82,1049.67,627.73,503.86,1233.28,677.27,1035.64,954.3,778.09,1006.6,805.48,1121.53,988.31,937.23,632.42,779.11,1097.36,671.48,579.47,1028.58,646.83,550.68,1176.44,660.95,992.66,934.46,742.5,911.1,827.2,1078.61,895.92,914.62,652.51,803.83,1103.08,718.06,460.66,1032.54,594.64,518.64,1259.69,562.25,996.26,961.28,800.41,937.85,853.66,1052.71,971.09,866.21,544.06,793.8,922.59,709.41,386.78,1050.57,575.05,497.14,1221.53,643.67,947.1,740.81,1006.57,903.61,1181.4,918.37,909.15,574.1,815.87,1054.32,755.88,480.9,1067.38,621.01,559.11,1169.67,626.8,1039.11,967.07,838.05,929.34,848.56,1105.37,898.05,930.87,689.1,864.33,999.11,715.12,438.66,1046.7,628.3,558.42,1224.99,593.98,959.67,917.25,806.25,932.49,858.19,1094.34,876.91,957.78,444.92,864.03,1023.87,719.37,468.73,1098.91,674.52,654.53,1243.42,630.26,1023.87,967.95,758.73,900.81,832.29,1138.08,934.39,942.61,705.75,892.04,1072.34,699.61,470.48,1027.16,698.42,629.37,1232.33,646.59,1057.69,1005.7,841.32,966.62,897.68,1037.59,970.56,964.31,648.83,871.7,1073.5,686.8,396.02,1063.69,661.06,535.08,1256.42,634.83,1014.38,985.36,808.99,883.39,843.7,1106.63,928.88,971.42,623.15,840.2,1114.36,754.01,478.11,1060.61,653.41,572.21,1085.96,605.11,1012.41,946,821.41,899.48,881.33,1086.22,908.63,903.33,806.59,904.21,1043.83,759.2,573.34,1050.47,643.73,558.62,1188.1,614.96,1014.22,948.37,739.05,940.69,820.28,1047.63,875.69,887.64,730.61,871.67,1150.18,656.19,480.99,1051.96,576.96,473.12,1168.02,607.37,967.19,915.96,771.81,920.09,825.18,1035.03,901.57,899.13,712.55,897.64,1120.48,703.45,497.22,1058.98,601.57,508.41,1207.82,650.73,1039.61,940.23,737.85,934.76,854.07,1072.96,973.13,921.52,695.5,881.19,1042.13,719.86,514.99,1018.13,679.09,552.67,1192.49,582.82,1003.79,984.33,768.44,877.68,869.2,1076.97,846.24,918.56,640.81,789.05,1070.52,738.29,493.38,1004.63,614.64,614.89,1191.43,642.83,996.89,982.94,801.41,920.35,885.7,1058.05,886.86,951.07,767.89,877.06,1073.81,778.23,602.3,1078.95,658.61,621.73,1230.81,640.61,1042.34,969.31,846.65,924.65,865.15,1127.33,841.37,956.63,719.99,938.51,1135.81,747.2,519.96,1075.48,678.87,699.24,1198.69,639.11,1056.33,885.48,719.47,917.56,872.35,1110.53,861.08,938.68,766.12,879.63,972.62,664.9,383.9,1073.48,600.61,502.88,1140.52,664.35,1011.01,952.43,765.93,933.32,831.68,1052.06,862.07,900.35,634.59,860.56,1036.88,558.77,120.9,1021.41,567.86,336.38,1263.44,593.52,1030.46,960.98,811.28,916.48,762.57,1194.92,918.41,947.16,380.17,308.47,1158.01,723.73,427.71,1037.65,676.93,663.37,1191.72,644.58,1002.68,997.46,786.56,928.42,823.54,1064.36,868.18,892.52,520.87,802.77,1196.31,733.94,492.34,1110.84,658.77,534.64,1271.7,637.04,1057.53,1008.45,794.11,980.59,923.01,1098.3,913.27,949.14,801.09,937.53,1121.97,718.95,370.91,1136.45,656.98,646.85,1243.38,640.82,1072.11,988.84,879.93,932.99,851.11,1129.08,873.5,917.09,633.75,969.29,1162.73,777.74,588.57,1089.81,671.58,534.7,1298.55,652.87,1027.24,1063.18,864.34,879.94,942.04,1131.48,989.42,1016.12,704.13,977.13,1226.93,718.9,382.06,1077.37,675.61,498.59,1303.23,708.2,1068.6,995.16,812.01,1051.45,774,1214.71,902.92,943.89,427.43,616.97,1034.87,661.47,533.1,997.36,611.84,567.37,1214.06,663.43,985.39,860.39,768.8,862.71,853.45,1106.29,888.18,932.26,664.84,809.89],[0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0],["1","31","61","91","121","151","181","211","241","270","300","330","360","390","420","450","480","510","2","32","62","92","122","152","182","212","242","271","301","331","361","391","421","451","481","511","3","33","63","93","123","153","183","213","243","272","302","332","362","392","422","452","482","512","4","34","64","94","124","154","184","214","244","273","303","333","363","393","423","453","483","513","5","35","65","95","125","155","185","215","245","274","304","334","364","394","424","454","484","514","6","36","66","96","126","156","186","216","246","275","305","335","365","395","425","455","485","515","7","37","67","97","127","157","187","217","247","276","306","336","366","396","426","456","486","516","8","38","68","98","128","158","188","218","248","277","307","337","367","397","427","457","487","517","9","39","69","99","129","159","189","219","278","308","338","368","398","428","458","488","518","10","40","70","100","130","160","190","220","249","279","309","339","369","399","429","459","489","519","11","41","71","101","131","161","191","221","250","280","310","340","370","400","430","460","490","520","12","42","72","102","132","162","192","222","251","281","311","341","371","401","431","461","491","521","13","43","73","103","133","163","193","223","252","282","312","342","372","402","432","462","492","522","14","44","74","104","134","164","194","224","253","283","313","343","373","403","433","463","493","523","15","45","75","105","135","165","195","225","254","284","314","344","374","404","434","464","494","524","16","46","76","106","136","166","196","226","255","285","315","345","375","405","435","465","495","525","17","47","77","107","137","167","197","227","256","286","316","346","376","406","436","466","496","526","18","48","78","108","138","168","198","228","257","287","317","347","377","407","437","467","497","527","19","49","79","109","139","169","199","229","258","288","318","348","378","408","438","468","498","528","20","50","80","110","140","170","200","230","259","289","319","349","379","409","439","469","499","529","21","51","81","111","141","171","201","231","260","290","320","350","380","410","440","470","500","530","22","52","82","112","142","172","202","232","261","291","321","351","381","411","441","471","501","531","23","53","83","113","143","173","203","233","262","292","322","352","382","412","442","472","502","532","24","54","84","114","144","174","204","234","263","293","323","353","383","413","443","473","503","533","25","55","85","115","145","175","205","235","264","294","324","354","384","414","444","474","504","534","26","56","86","116","146","176","206","236","265","295","325","355","385","415","445","475","505","535","27","57","87","117","147","177","207","237","266","296","326","356","386","416","446","476","506","536","28","58","88","118","148","178","208","238","267","297","327","357","387","417","447","477","507","537","29","59","89","119","149","179","209","239","268","298","328","358","388","418","448","478","508","538","30","60","90","120","150","180","210","240","269","299","329","359","389","419","449","479","509","539"],[1053.89,677.42,392.89,996.93,595.6,523.48,1139.67,583.71,934.16,947.43,774.44,863.96,727.21,983.65,804.74,843.77,713,773.86,1027.16,721.26,503.13,1025.19,635.25,514.64,1108.76,570.62,987.23,948.82,766.52,904.85,816.11,1097.75,866.47,911.86,637.7,725.34,1009.42,634,332.56,1014.21,540.13,463.87,1195.59,560.09,1016.25,880.68,718.46,909.09,811.92,1061.93,796.2,892.67,555.47,827.79,1089.27,703.6,304.57,1089.48,653.57,593.86,1304.21,654.56,1068.02,1008.14,851.67,901.87,891.24,1163.25,970.19,897.71,506.64,735.66,1090.53,739.62,592.47,1089.56,684.64,555.64,1185.9,577.58,1038.38,998.36,791.21,958.55,860.19,1111.95,910.6,944,747.03,866.12,1150.69,655.41,449.82,1049.67,628.01,514.12,1233.28,671.85,1035.64,953.59,778.09,1005.97,805.73,1121.53,988.31,940.13,633.85,779.75,1097.36,672.13,579.47,1028.58,645.93,550.48,1176.44,657.49,992.66,935.03,742.5,912.17,827.74,1078.61,895.92,912.6,656.64,804.08,1103.08,719.19,460.66,1032.54,594.86,521.26,1259.69,569.51,996.26,961.32,800.41,940.57,853,1052.71,971.09,866.82,545.18,794.26,922.59,710.59,386.78,1050.57,575.26,484.85,1221.53,642.52,947.52,740.81,1005.15,903.65,1181.4,918.37,908.66,578.83,813.75,1054.32,755.91,480.9,1067.38,620.58,563.2,1169.67,639.76,1039.11,966.04,838.05,930.94,848.27,1105.37,898.05,931.45,689.22,865.41,999.11,713.66,438.66,1046.7,630.24,559.5,1224.99,604.97,959.67,918.11,806.25,929.86,858.27,1094.34,876.91,958.34,446.72,862.98,1023.87,720.95,468.73,1098.91,674.67,646.06,1243.42,620.54,1023.87,967.48,758.73,901.39,832.83,1138.08,934.4,942.59,706.48,893.27,1072.34,701.04,470.48,1027.16,698.57,620.56,1232.33,640.6,1057.69,1005.81,841.32,966.21,897.47,1037.59,970.56,964.45,649.13,872.75,1073.5,685.98,396.02,1063.69,663.29,530.1,1256.42,626.41,1014.38,985.94,808.99,886.44,843.34,1106.63,928.88,971.21,620.32,840.53,1114.36,753.89,478.11,1060.61,652.13,571.05,1085.96,603.83,1012.41,944.71,821.41,898.39,881.85,1086.22,908.63,904.85,810.49,905.74,1043.83,758.66,573.34,1050.47,642.25,553.64,1188.1,622.67,1014.22,948.35,739.05,941.47,820.84,1047.63,875.7,886.54,725.25,871.42,1150.18,655.57,480.99,1051.96,575.67,471.77,1168.02,607.08,967.19,916.58,771.81,915.99,825.77,1035.03,901.57,898.08,708.56,897.23,1120.48,701.34,497.22,1058.98,601.48,502.38,1207.82,661.21,1039.61,941.3,737.85,932.9,853.72,1072.96,973.13,921.03,699.4,880.4,1042.13,719.63,514.99,1018.13,681.03,550.12,1192.49,599.94,1003.79,984.97,768.44,878.29,869.28,1076.97,846.24,917.15,644.42,788.34,1070.52,738.02,493.38,1004.63,615.69,621.14,1191.43,640.01,996.89,982.78,801.41,920.64,885.28,1058.05,886.87,948.77,765.02,876.48,1073.81,779.36,602.3,1078.95,657.12,614.42,1230.81,633.49,1042.34,967.83,846.65,926.45,865.05,1127.33,841.38,955.89,723.41,938.56,1135.81,746.81,519.96,1075.48,678.19,708.31,1198.69,628.08,1056.33,884.75,719.47,917.45,871.66,1110.53,861.08,937.61,761.83,878.62,972.62,665.16,383.9,1073.48,601.12,499.05,1140.52,655.92,1011.01,952.54,765.93,933.81,832.41,1052.06,862.07,899.56,635.71,861.05,1036.88,560.36,120.9,1021.41,567.55,343.34,1263.44,598.92,1030.46,961.68,811.28,918.42,762.4,1194.92,918.41,946.73,381.29,308.79,1158.01,725.06,427.71,1037.65,676.24,663.53,1191.72,647.28,1002.68,998.19,786.56,928.48,823.32,1064.36,868.18,892.22,518.68,802.43,1196.31,734.6,492.34,1110.84,658.98,534.79,1271.7,629.42,1057.53,1008.21,794.11,979.86,923.45,1098.3,913.28,950.38,806.3,936.15,1121.97,719.83,370.91,1136.45,655.38,642.39,1243.38,646.79,1072.11,988.58,879.93,930.44,850.89,1129.08,873.49,917.08,637.36,970.06,1162.73,776.62,588.57,1089.81,671.46,538.51,1298.55,652.28,1027.24,1064.33,864.34,880.32,941.86,1131.48,989.42,1015.36,708.21,977.32,1226.93,719.71,382.06,1077.37,673.98,503.99,1303.23,704.61,1068.6,994.19,812.01,1049.27,773.79,1214.71,902.92,943.91,423.82,616.59,1034.87,661.96,533.1,997.36,610.21,566.74,1214.06,653.14,985.39,860.68,768.8,864.97,853.69,1106.29,888.17,932.09,657.67,812.01],[0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0],["2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>cultivar<\/th>\n      <th>zone<\/th>\n      <th>location<\/th>\n      <th>yield_lsm<\/th>\n      <th>smith.w.x<\/th>\n      <th>units<\/th>\n      <th>yield<\/th>\n      <th>smith.w.y<\/th>\n      <th>year<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bt","buttons":[{"extend":"copy","filename":null},{"extend":"excel","filename":null}],"deferRender":true,"scroller":true,"scrollX":true,"scrollY":"60vh","columnDefs":[{"width":"200px","targets":"_all"},{"className":"dt-right","targets":[3,4,6,7]}],"initComplete":"function(settings, json) {\n$(this.api().table().header()).css({'background-color': '#000', 'color': '#fff'});\n}","order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.initComplete"],"jsHooks":[]}</script><p>The BLUEs correlation between <code>H2Cal</code> and <code>asrml</code> is (r = 0.9999286)</p>
</div>
<div id="blups-comparison" class="section level2">
<h2 class="hasAnchor">
<a href="#blups-comparison" class="anchor"></a>BLUPs comparison</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">blups.comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html">merge</a></span><span class="op">(</span><span class="va">blups.asrml</span>, <span class="va">blups.h2cal</span>
                    , by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cultivar"</span><span class="op">)</span><span class="op">)</span>

<span class="va">rs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/unstructured.html">cor</a></span><span class="op">(</span><span class="va">blups.comp</span><span class="op">$</span><span class="va">yield</span>, <span class="va">blups.comp</span><span class="op">$</span><span class="va">predicted.value</span><span class="op">)</span> <span class="co"># 0.9820397</span>
<span class="va">rs</span>
<span class="co">## [1] 0.9820397</span>

<span class="va">blups.comp</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../../reference/web_table.html">web_table</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-19fbcd230cac20adae06" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-19fbcd230cac20adae06">{"x":{"filter":"none","extensions":["Buttons","Scroller"],"data":[["22455","23286","23524","24054","24521","24984","25512","25965","26362","26742","26777","27110","27125","27130","27543","27546","27548","27590","27592","27593","27599","27600","27605","27609","27669","28128","28209","28949","28950","28954"],[803.04,829.95,803.91,863.95,869.36,856.33,843.42,839.25,845.38,859.03,838.46,865.39,873.39,854.39,856.12,849.12,831.73,852.34,843.37,859.13,878.96,866.74,831.13,798.91,849.48,885.15,873.55,899.65,866.78,836.24],[53.62,53.62,53.62,53.62,53.63,53.63,53.62,53.63,53.68,53.62,53.62,53.62,53.62,53.62,53.62,53.63,53.62,53.63,53.62,53.62,53.62,53.62,53.63,53.62,53.63,53.62,53.62,53.62,53.62,53.63],["Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable"],[808.18,826.82,803.73,853.44,868.15,853.8,843.59,838.44,837.34,856.62,833.64,861.86,867.83,849.64,857.75,849.43,836.64,853.92,840.66,857.91,875.05,865.53,828.56,784.24,845.58,883.35,870.31,895.25,853.62,836.58]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>cultivar<\/th>\n      <th>predicted.value<\/th>\n      <th>std.error<\/th>\n      <th>status<\/th>\n      <th>yield<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bt","buttons":[{"extend":"copy","filename":null},{"extend":"excel","filename":null}],"deferRender":true,"scroller":true,"scrollX":true,"scrollY":"60vh","columnDefs":[{"width":"200px","targets":"_all"},{"className":"dt-right","targets":[1,2,4]}],"initComplete":"function(settings, json) {\n$(this.api().table().header()).css({'background-color': '#000', 'color': '#fff'});\n}","order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.initComplete"],"jsHooks":[]}</script><p>The BLUPs correlation between <code>H2Cal</code> and <code>asrml</code> is (r = 0.9820397)</p>
</div>
</div>
<div id="single-stage-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#single-stage-analysis" class="anchor"></a>Single-stage analysis</h1>
<div id="asreml-1" class="section level2">
<h2 class="hasAnchor">
<a href="#asreml-1" class="anchor"></a>asreml</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">asreml</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span><span class="st">"scipen"</span><span class="op">=</span><span class="fl">100</span>,<span class="st">"digits"</span><span class="op">=</span> <span class="fl">4</span> <span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.options.html">asreml.options</a></span><span class="op">(</span>maxit<span class="op">=</span><span class="fl">100</span><span class="op">)</span> <span class="co"># Set asreml iteration</span>

<span class="co">##### Fit a single-stage model #####</span>
<span class="co">## incomplete block and replicate location-specific</span>
<span class="co">## location-specifice residual variance</span>

<span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html">asreml</a></span><span class="op">(</span>fixed       <span class="op">=</span> <span class="va">yield</span> <span class="op">~</span> <span class="va">zone</span>,
              random      <span class="op">=</span> <span class="op">~</span> <span class="va">rep</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/modelFunctions.html">at</a></span><span class="op">(</span><span class="va">location</span><span class="op">)</span> <span class="op">+</span> <span class="va">rep</span><span class="op">:</span><span class="va">alpha</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/modelFunctions.html">at</a></span><span class="op">(</span><span class="va">location</span><span class="op">)</span> <span class="op">+</span> <span class="va">zone</span><span class="op">:</span><span class="va">location</span> <span class="op">+</span> 
                             <span class="va">cultivar</span> <span class="op">+</span> <span class="va">cultivar</span><span class="op">:</span><span class="va">zone</span><span class="op">:</span><span class="va">location</span><span class="op">+</span> <span class="va">cultivar</span><span class="op">:</span><span class="va">zone</span>,
              residual    <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/modelFunctions.html">dsum</a></span><span class="op">(</span><span class="op">~</span><span class="op">(</span><span class="va">units</span><span class="op">)</span><span class="op">|</span><span class="va">location</span><span class="op">)</span>,
              data        <span class="op">=</span> <span class="va">fb</span>,
              predict     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/predict.asreml.html">predict.asreml</a></span><span class="op">(</span>classify <span class="op">=</span> <span class="st">"cultivar"</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/asreml/man/update.asreml.html">update.asreml</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span>

<span class="va">blups.asreml</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">predictions</span><span class="op">$</span><span class="va">pvals</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
</div>
<div id="h2cal-1" class="section level2">
<h2 class="hasAnchor">
<a href="#h2cal-1" class="anchor"></a>H2cal</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://inkaverse.com/">inti</a></span><span class="op">)</span>

<span class="va">model</span> <span class="op">&lt;-</span> <span class="va">fb</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../../reference/H2cal.html">H2cal</a></span><span class="op">(</span>trait <span class="op">=</span> <span class="st">"yield"</span>
        , gen.name <span class="op">=</span> <span class="st">"cultivar"</span>
        , loc.name <span class="op">=</span> <span class="st">"location"</span>
        , rep.n <span class="op">=</span> <span class="fl">2</span>
        , loc.n <span class="op">=</span> <span class="fl">18</span>
        , ran.model <span class="op">=</span> <span class="st">"1 + (1|rep:location) + (1|rep:alpha:location) + (1|cultivar:zone:location) + (1|cultivar:zone) + (1|cultivar:location) + (1|cultivar)"</span>
        , fix.model <span class="op">=</span> <span class="st">"0 + (1|rep:location) + (1|rep:alpha:location) + (1|cultivar:zone:location) + (1|cultivar:zone) + (1|cultivar:location) + cultivar"</span>
        , summary <span class="op">=</span> <span class="cn">T</span>
        , emmeans <span class="op">=</span> <span class="cn">T</span>
        , plot_diag <span class="op">=</span> <span class="cn">F</span>
        <span class="op">)</span>
<span class="co">## Linear mixed model fit by REML ['lmerMod']</span>
<span class="co">## Formula: yield ~ 1 + (1 | rep:location) + (1 | rep:alpha:location) + (1 |  </span>
<span class="co">##     cultivar:zone:location) + (1 | cultivar:zone) + (1 | cultivar:location) +  </span>
<span class="co">##     (1 | cultivar)</span>
<span class="co">##    Data: dt.rm</span>
<span class="co">## Weights: weights</span>
<span class="co">## </span>
<span class="co">## REML criterion at convergence: 12023</span>
<span class="co">## </span>
<span class="co">## Scaled residuals: </span>
<span class="co">##     Min      1Q  Median      3Q     Max </span>
<span class="co">## -5.1177 -0.3295 -0.0109  0.3574  4.0993 </span>
<span class="co">## </span>
<span class="co">## Random effects:</span>
<span class="co">##  Groups                 Name        Variance      Std.Dev. </span>
<span class="co">##  cultivar:location      (Intercept)     0.0005286   0.02299</span>
<span class="co">##  cultivar:zone:location (Intercept)  2208.5761240  46.99549</span>
<span class="co">##  rep:alpha:location     (Intercept)   942.4310254  30.69904</span>
<span class="co">##  cultivar:zone          (Intercept)   128.9649012  11.35627</span>
<span class="co">##  rep:location           (Intercept) 42663.3346159 206.55105</span>
<span class="co">##  cultivar               (Intercept)   727.6650414  26.97527</span>
<span class="co">##  Residual                            1397.5707455  37.38410</span>
<span class="co">## Number of obs: 1069, groups:  </span>
<span class="co">## cultivar:location, 539; cultivar:zone:location, 539; rep:alpha:location, 251; cultivar:zone, 90; rep:location, 36; cultivar, 30</span>
<span class="co">## </span>
<span class="co">## Fixed effects:</span>
<span class="co">##             Estimate Std. Error t value</span>
<span class="co">## (Intercept)   847.60      34.93   24.27</span>
<span class="co">## optimizer (nloptwrap) convergence code: 0 (OK)</span>
<span class="co">## unable to evaluate scaled gradient</span>
<span class="co">## Model failed to converge: degenerate  Hessian with 1 negative eigenvalues</span>

<span class="va">blups.h2cal</span> <span class="op">&lt;-</span> <span class="va">model</span><span class="op">$</span><span class="va">blups</span> </code></pre></div>
</div>
<div id="blups-comparison-1" class="section level2">
<h2 class="hasAnchor">
<a href="#blups-comparison-1" class="anchor"></a>BLUPs comparison</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">blups.comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html">merge</a></span><span class="op">(</span><span class="va">blups.asreml</span>, <span class="va">blups.h2cal</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cultivar"</span><span class="op">)</span><span class="op">)</span>

<span class="va">rs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/unstructured.html">cor</a></span><span class="op">(</span><span class="va">blups.comp</span><span class="op">$</span><span class="va">predicted.value</span>, <span class="va">blups.comp</span><span class="op">$</span><span class="va">yield</span><span class="op">)</span> <span class="co"># 0.9202</span>
<span class="va">rs</span>
<span class="co">## [1] 0.9202313</span>

<span class="va">blups.comp</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../../reference/web_table.html">web_table</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-57b2edc0021b52d3ef77" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-57b2edc0021b52d3ef77">{"x":{"filter":"none","extensions":["Buttons","Scroller"],"data":[["22455","23286","23524","24054","24521","24984","25512","25965","26362","26742","26777","27110","27125","27130","27543","27546","27548","27590","27592","27593","27599","27600","27605","27609","27669","28128","28209","28949","28950","28954"],[799.61,829.23,804.42,871.04,868.33,855.09,839.17,840.7,849.6,859.66,842.77,863.99,875.58,856.72,851.09,842.82,826.29,849.08,844.02,856.7,873.85,862.36,831.4,814.92,853.46,884.02,874.32,898.71,877.48,831.26],[53.45,53.45,53.45,53.45,53.46,53.46,53.45,53.46,53.5,53.45,53.45,53.45,53.45,53.45,53.45,53.46,53.45,53.46,53.45,53.45,53.45,53.45,53.46,53.45,53.46,53.45,53.45,53.46,53.45,53.46],["Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable"],[808.37,827.55,802.55,855.79,867.17,854.35,842.2,835.42,836.58,857.36,831.83,863.83,866.57,849.15,858.21,849.08,836.36,851.76,838.04,858.93,875.66,866.87,829.61,781.23,846.78,883.39,870.74,894.25,853.29,835]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>cultivar<\/th>\n      <th>predicted.value<\/th>\n      <th>std.error<\/th>\n      <th>status<\/th>\n      <th>yield<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bt","buttons":[{"extend":"copy","filename":null},{"extend":"excel","filename":null}],"deferRender":true,"scroller":true,"scrollX":true,"scrollY":"60vh","columnDefs":[{"width":"200px","targets":"_all"},{"className":"dt-right","targets":[1,2,4]}],"initComplete":"function(settings, json) {\n$(this.api().table().header()).css({'background-color': '#000', 'color': '#fff'});\n}","order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.initComplete"],"jsHooks":[]}</script><p>The BLUPs correlation between <code>H2Cal</code> and <code>asrml</code> is (r = 0.9202313)</p>
</div>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-buntaran2020Cross" class="csl-entry">
Buntaran, H., H.-P. Piepho, P. Schmidt, J. Rydén, M. Halling, et al. 2020. Cross-validation of stagewise mixed-model analysis of <span>Swedish</span> variety trials with winter wheat and spring barley. Crop Science 60(5): 2221–2240. doi: <a href="https://doi.org/10.1002/csc2.20177">10.1002/csc2.20177</a>.
</div>
<div id="ref-R-inti" class="csl-entry">
Lozano-Isla, F. 2020. Inti: Tools and statistical procedures in plant science.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Flavio Lozano-Isla.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'f3d6fbee3fef1a17738422273d5317f5',
    indexName: 'inti',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
